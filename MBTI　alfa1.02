<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ÊÄßÊ†ºË®∫Êñ≠„ÉÜ„Çπ„ÉàÔºàMBTIÔºâ</title>
  <meta property="og:title" content="ÊÄßÊ†ºË®∫Êñ≠„ÉÜ„Çπ„ÉàÔºàMBTIÔºâ">
  <meta property="og:description" content="32Âïè„ÅÆË≥™Âïè„Åß„ÅÇ„Å™„Åü„ÅÆMBTIÊÄßÊ†º„Çø„Ç§„Éó„ÇíË®∫Êñ≠ÔºÅ">
  <meta property="og:image" content="https://dummyimage.com/600x315/2196f3/fff&text=MBTI+Ë®∫Êñ≠">
  <meta property="og:url" content="https://example.com">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="ÊÄßÊ†ºË®∫Êñ≠„ÉÜ„Çπ„ÉàÔºàMBTIÔºâ">
  <meta name="twitter:description" content="32Âïè„ÅÆË≥™Âïè„Åß„ÅÇ„Å™„Åü„ÅÆMBTIÊÄßÊ†º„Çø„Ç§„Éó„ÇíË®∫Êñ≠ÔºÅ">
  <meta name="twitter:image" content="https://dummyimage.com/600x315/2196f3/fff&text=MBTI+Ë®∫Êñ≠">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXXX-X"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-XXXXXXXXX-X');
  </script>
  <style>
    body {
      font-family: "Hiragino Sans", "Meiryo", sans-serif;
      background: #f4f4f9;
      margin: 0;
      padding: 20px;
      max-width: 820px;
      min-height: 100vh;
      margin: 0 auto;
    }
    h1 { text-align: center; margin-bottom: 30px; }
    .lang-switcher { text-align:right; margin-bottom:1rem;}
    .lang-btn { background: #eee; color:#333; border:none; border-radius:0.5rem; padding:0.3rem 1rem; margin-left:0.5rem; cursor:pointer;}
    .question-card {
      background: #fff;
      border-radius: 0.8rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      margin-bottom: 2rem;
      padding: 1.2rem;
    }
    .question-card.unanswered { border:2px solid #d32f2f; background: #fff0f0;}
    .options { display: flex; gap: 10px; margin-top: 12px; }
    label.option-label {
      flex: 1;
      background: #e0f2f1;
      border-radius: 0.5rem;
      padding: 0.7rem 0.5rem;
      text-align: center;
      cursor: pointer;
      transition: background .2s, color .2s, transform 0.12s;
      outline: none;
      user-select: none;
    }
    input[type=radio]:checked + label.option-label {
      background: #2196F3;
      color: #fff;
    }
    label.option-label.animate {
      animation: option-press 0.18s;
    }
    @keyframes option-press {
      0% { transform: scale(1);}
      40% { transform: scale(0.93);}
      100% { transform: scale(1);}
    }
    .progress-bar-bg {
      width: 100%; height: 16px; background: #e0e0e0; border-radius: 8px; margin: 20px 0;
    }
    .progress-bar { height: 100%; border-radius: 8px; background: #4caf50; transition: width 0.4s; }
    #submitBtn, #resetBtn, .nav-btn {
      display: inline-block; margin: 30px 10px 0 10px;
      padding: 16px 40px; font-size: 1.15rem; border-radius: 0.8rem;
      border: none; color: #fff; background: #4caf50; cursor: pointer;
      transition: background .2s;
    }
    #resetBtn { background: #2196F3; margin-top: 16px; }
    .nav-btn { background: #888; }
    .nav-btn:disabled { background: #ccc; color: #fff; cursor: not-allowed; }
    .result-type-card {
      background: #fff;
      border-left: 7px solid #2196F3;
      border-radius: 0.8rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      padding: 1.2rem;
      margin-bottom: 2rem;
    }
    .share-btn {
      display: inline-block;
      margin: 0.5rem;
      padding: 0.7rem 1.6rem;
      background: #2196F3;
      color: #fff;
      border-radius: 0.5rem;
      text-decoration: none;
      font-size: 1.1rem;
      font-weight: bold;
      transition: background 0.2s;
      border: none;
      cursor: pointer;
    }
    .share-btn.x { background: #000; }
    .share-btn.line { background: #00c300; }
    .share-btn.facebook { background: #3b5998; }
    .share-btn.instagram { background: #e4405f; }
    .share-btn.threads { background: #222; }
    .share-btn.copy { background: #888; }
    .share-btn:hover { filter: brightness(0.92); }
    .error-message {
      color: #d32f2f;
      font-weight: bold;
      text-align: center;
      margin-bottom: 1.5rem;
    }
    @media (max-width:600px) {
      .options { flex-direction: column; }
      #submitBtn, #resetBtn, .nav-btn { width: 100%; margin: 10px 0; }
      .share-btn { width: 100%; margin: 0.5rem 0; }
    }
  </style>
</head>
<body>
  <h1>ÊÄßÊ†ºË®∫Êñ≠„ÉÜ„Çπ„Éà</h1>
  <div class="lang-switcher">
    <button class="lang-btn" onclick="switchLang('ja')">Êó•Êú¨Ë™û</button>
    <button class="lang-btn" onclick="switchLang('en')">English</button>
  </div>
  <div id="app"></div>
  <script>
    // --- Â§öË®ÄË™û„Éá„Éº„Çø ---
    const DATA = {
      ja: {
        questions: [
          { text: "‰∫∫„Å®„ÅÑ„Çã„Çà„Çä‰∏Ä‰∫∫„ÅÆÊôÇÈñì„ÅåÂ•Ω„Åç„Å†", img: "üåô", axis: "I" },
          { text: "ÂàùÂØæÈù¢„Åß„ÇÇ„Åô„Åê„Å´Êâì„Å°Ëß£„Åë„Çâ„Çå„Çã", img: "ü§ù", axis: "E" },
          { text: "Áâ©‰∫ã„ÇíÁõ¥ÊÑü„ÅßÊçâ„Åà„Çã„Åì„Å®„ÅåÂ§ö„ÅÑ", img: "üí°", axis: "N" },
          { text: "ÁèæÂÆüÁöÑ„ÅßÂÆüÁî®ÊÄß„ÇíÈáçË¶ñ„Åô„Çã", img: "üîß", axis: "S" },
          { text: "Ë´ñÁêÜÁöÑ„Å´ËÄÉ„Åà„Çã„ÅÆ„ÅåÂæóÊÑè„Å†", img: "üß†", axis: "T" },
          { text: "ÊÑüÊÉÖ„ÇÑÊ∞óÊåÅ„Å°„ÇíÈáçË¶ñ„Åô„Çã", img: "üíñ", axis: "F" },
          { text: "Ë®àÁîªÁöÑ„Å´Áâ©‰∫ã„ÇíÈÄ≤„ÇÅ„Çã", img: "üìÖ", axis: "J" },
          { text: "ÊüîËªü„Å´ÂØæÂøú„Åô„Çã„ÅÆ„ÅåÂæóÊÑè„Å†", img: "üåä", axis: "P" },
          { text: "Â§ß‰∫∫Êï∞„ÅÆÈõÜ„Åæ„Çä„ÅåÂ•Ω„Åç„Å†", img: "üéâ", axis: "E" },
          { text: "Á¥∞„Åã„ÅÑÈÉ®ÂàÜ„Å´Ê∞ó„Åå„Å§„Åè", img: "üîç", axis: "S" },
          { text: "Êñ∞„Åó„ÅÑ„Ç¢„Ç§„Éá„Ç¢„ÇíËÄÉ„Åà„Çã„ÅÆ„ÅåÊ•Ω„Åó„ÅÑ", img: "‚ú®", axis: "N" },
          { text: "‰∫∫„ÅÆÊ∞óÊåÅ„Å°„Å´ÊïèÊÑü„Å†", img: "üëÇ", axis: "F" },
          { text: "Áâ©‰∫ã„ÇíÂÆ¢Ë¶≥ÁöÑ„Å´Âà§Êñ≠„Åô„Çã", img: "‚öñÔ∏è", axis: "T" },
          { text: "Ê±∫Êñ≠„ÇíÂÖàÂª∂„Å∞„Åó„Å´„Åó„Åå„Å°„Å†", img: "‚è≥", axis: "P" },
          { text: "‰∫∫„Çí„Çµ„Éù„Éº„Éà„Åô„Çã„ÅÆ„ÅåÂ•Ω„Åç„Å†", img: "ü´Ç", axis: "F" },
          { text: "„É´„Éº„É´„ÇÑÊâãÈ†Ü„ÇíÂÆà„Çã", img: "üìè", axis: "J" },
          { text: "Ëá™ÂàÜ„ÅÆ‰∏ñÁïå„Å´Ê≤°È†≠„Åô„Çã„Åì„Å®„ÅåÂ§ö„ÅÑ", img: "üîÆ", axis: "I" },
          { text: "Ë©±„ÅóÂêà„ÅÑ„Åß„É™„Éº„ÉÄ„Éº„Ç∑„ÉÉ„Éó„Çí„Å®„Çã", img: "üó£Ô∏è", axis: "E" },
          { text: "Êú™Êù•„ÅÆÂèØËÉΩÊÄß„ÇíËÄÉ„Åà„Çã„ÅÆ„ÅåÂ•Ω„Åç„Å†", img: "üöÄ", axis: "N" },
          { text: "‰ªä„Åì„ÅÆÁû¨Èñì„ÇíÂ§ßÂàá„Å´„Åô„Çã", img: "‚è∞", axis: "S" },
          { text: "Ë≠∞Ë´ñ„ÅßÁõ∏Êâã„ÇíË™¨Âæó„Åô„Çã„ÅÆ„ÅåÂæóÊÑè„Å†", img: "üí¨", axis: "T" },
          { text: "‰∫∫„ÅÆÂΩπ„Å´Á´ã„Å§„Åì„Å®„Å´„ÇÑ„Çä„Åå„ÅÑ„ÇíÊÑü„Åò„Çã", img: "ü§≤", axis: "F" },
          { text: "Ë®àÁîª„Çà„Çä„ÇÇÊµÅ„Çå„Å´‰ªª„Åõ„Çã", img: "üçÉ", axis: "P" },
          { text: "„Åç„Å°„Çì„Å®Êï¥ÁêÜÊï¥È†ì„Åô„Çã„ÅÆ„ÅåÂ•Ω„Åç„Å†", img: "üóÇÔ∏è", axis: "J" },
          { text: "Ëá™ÂàÜ„ÅÆËÄÉ„Åà„ÇíÊ∑±„ÅèÊéò„Çä‰∏ã„Åí„Çã", img: "üï≥Ô∏è", axis: "I" },
          { text: "Áü•„Çâ„Å™„ÅÑ‰∫∫„Å®„ÇÇÁ©çÊ•µÁöÑ„Å´Ë©±„Åô", img: "üó®Ô∏è", axis: "E" },
          { text: "ÊäΩË±°ÁöÑ„Å™Ë©±È°å„ÅåÂ•Ω„Åç„Å†", img: "üåÄ", axis: "N" },
          { text: "‰∫ãÂÆü„ÇÑ„Éá„Éº„Çø„ÇíÈáçË¶ñ„Åô„Çã", img: "üìä", axis: "S" },
          { text: "ÊÑüÊÉÖ„ÇíË°®„Å´Âá∫„Åô„Åì„Å®„ÅåÂ§ö„ÅÑ", img: "üòä", axis: "F" },
          { text: "Áâ©‰∫ã„ÇíÂäπÁéáÁöÑ„Å´ÈÄ≤„ÇÅ„Åü„ÅÑ", img: "‚ö°", axis: "J" },
          { text: "ÊÄù„ÅÑ„Å§„Åç„ÅßË°åÂãï„Åô„Çã„Åì„Å®„ÅåÂ§ö„ÅÑ", img: "üé≤", axis: "P" },
          { text: "Ëá™ÂàÜ„ÅÆËÄÉ„Åà„Çí„ÅØ„Å£„Åç„Çä‰ºù„Åà„Çã", img: "üì¢", axis: "T" }
        ],
        options: ["„ÅÇ„Å¶„ÅØ„Åæ„Çã","„ÇÑ„ÇÑ„ÅÇ„Å¶„ÅØ„Åæ„Çã","„Å©„Å°„Çâ„Åß„ÇÇ„Å™„ÅÑ","„ÅÇ„Åæ„Çä„ÅÇ„Å¶„ÅØ„Åæ„Çâ„Å™„ÅÑ","„ÅÇ„Å¶„ÅØ„Åæ„Çâ„Å™„ÅÑ"],
        next: "Ê¨°„ÅÆ„Éö„Éº„Ç∏",
        prev: "Ââç„ÅÆ„Éö„Éº„Ç∏",
        submit: "Ë®∫Êñ≠„Åô„Çã",
        reset: "„ÇÇ„ÅÜ‰∏ÄÂ∫¶Ë®∫Êñ≠„Åô„Çã",
        share: {
          x: "X„Åß„Ç∑„Çß„Ç¢",
          line: "LINE„Åß„Ç∑„Çß„Ç¢",
          facebook: "Facebook„Åß„Ç∑„Çß„Ç¢",
          instagram: "Instagram„Åß„Ç∑„Çß„Ç¢",
          copy: "ÁµêÊûú„Çí„Ç≥„Éî„Éº"
        },
        error: "„Åô„Åπ„Å¶„ÅÆË≥™Âïè„Å´ÂõûÁ≠î„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ",
        clear: "‰øùÂ≠ò„Éá„Éº„Çø„Çí„ÇØ„É™„Ç¢",
        resultNote: "‚ÄªMBTIË®∫Êñ≠„ÅØÊÄßÊ†º„ÅÆËâØ„ÅóÊÇ™„Åó„ÇíÊ±∫„ÇÅ„Çã„ÇÇ„ÅÆ„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ„ÅÇ„Å™„Åü„ÅÆÂÇæÂêë„ÇÑÂº∑„Åø„ÇíÁü•„Çã„Åü„ÇÅ„ÅÆÂèÇËÄÉ„Å®„Åó„Å¶„ÅîÊ¥ªÁî®„Åè„Å†„Åï„ÅÑ„ÄÇ",
        remain: n => `„ÅÇ„Å®${n}Âïè`,
        typeLabel: (mbti, name)=>`„ÅÇ„Å™„Åü„ÅÆMBTI„Çø„Ç§„Éó„ÅØ <span style="font-size:2rem">${mbti}</span> „Åß„Åô`
      },
      en: {
        questions: [
          { text: "I prefer spending time alone rather than with others.", img: "üåô", axis: "I" },
          { text: "I can open up quickly even with strangers.", img: "ü§ù", axis: "E" },
          { text: "I often rely on intuition.", img: "üí°", axis: "N" },
          { text: "I focus on practicality and reality.", img: "üîß", axis: "S" },
          { text: "I am good at thinking logically.", img: "üß†", axis: "T" },
          { text: "I value feelings and emotions.", img: "üíñ", axis: "F" },
          { text: "I like to plan ahead.", img: "üìÖ", axis: "J" },
          { text: "I am good at adapting flexibly.", img: "üåä", axis: "P" },
          { text: "I enjoy large gatherings.", img: "üéâ", axis: "E" },
          { text: "I notice details.", img: "üîç", axis: "S" },
          { text: "I enjoy coming up with new ideas.", img: "‚ú®", axis: "N" },
          { text: "I am sensitive to others' feelings.", img: "üëÇ", axis: "F" },
          { text: "I make objective judgments.", img: "‚öñÔ∏è", axis: "T" },
          { text: "I tend to postpone decisions.", img: "‚è≥", axis: "P" },
          { text: "I like supporting others.", img: "ü´Ç", axis: "F" },
          { text: "I follow rules and procedures.", img: "üìè", axis: "J" },
          { text: "I often get absorbed in my own world.", img: "üîÆ", axis: "I" },
          { text: "I take leadership in discussions.", img: "üó£Ô∏è", axis: "E" },
          { text: "I like thinking about future possibilities.", img: "üöÄ", axis: "N" },
          { text: "I value the present moment.", img: "‚è∞", axis: "S" },
          { text: "I am good at persuading others in discussions.", img: "üí¨", axis: "T" },
          { text: "I feel fulfilled by helping others.", img: "ü§≤", axis: "F" },
          { text: "I go with the flow rather than planning.", img: "üçÉ", axis: "P" },
          { text: "I like to organize and tidy up.", img: "üóÇÔ∏è", axis: "J" },
          { text: "I dig deep into my own thoughts.", img: "üï≥Ô∏è", axis: "I" },
          { text: "I actively talk to strangers.", img: "üó®Ô∏è", axis: "E" },
          { text: "I like abstract topics.", img: "üåÄ", axis: "N" },
          { text: "I value facts and data.", img: "üìä", axis: "S" },
          { text: "I often express my emotions.", img: "üòä", axis: "F" },
          { text: "I want to proceed efficiently.", img: "‚ö°", axis: "J" },
          { text: "I often act on impulse.", img: "üé≤", axis: "P" },
          { text: "I clearly express my thoughts.", img: "üì¢", axis: "T" }
        ],
        options: ["Strongly Agree","Agree","Neutral","Disagree","Strongly Disagree"],
        next: "Next Page",
        prev: "Previous Page",
        submit: "See Results",
        reset: "Restart",
        share: {
          x: "Share on X",
          line: "Share on LINE",
          facebook: "Share on Facebook",
          instagram: "Share on Instagram",
          copy: "Copy Result"
        },
        error: "Please answer all questions.",
        clear: "Clear saved data",
        resultNote: "‚ÄªMBTI is not a measure of good or bad personality. Use it as a reference to understand your tendencies and strengths.",
        remain: n => `${n} questions left`,
        typeLabel: (mbti, name)=>`Your MBTI type is <span style="font-size:2rem">${mbti}</span>`
      }
    };

    // --- MBTI„Çø„Ç§„ÉóÊÉÖÂ†±ÔºàÂÖ®16„Çø„Ç§„ÉóÔºâ ---
    const MBTI_TYPES = {
      "ISTJ": {
        name: { ja: "ÁÆ°ÁêÜËÄÖ", en: "Inspector" },
        desc: {
          ja: "Ë≤¨‰ªªÊÑü„ÅåÂº∑„Åè„ÄÅÁùÄÂÆü„Å´Áâ©‰∫ã„ÇíÈÄ≤„ÇÅ„ÇãÁèæÂÆü‰∏ªÁæ©ËÄÖ„ÄÇ„É´„Éº„É´„ÇÑÁß©Â∫è„ÇíÈáç„Çì„Åò„Çã„ÄÇ",
          en: "Responsible and realistic, values rules and order, and proceeds steadily."
        },
        strengths: {
          ja: "‰ø°È†ºÊÄß„ÄÅË®àÁîªÊÄß„ÄÅÂã§Âãâ„Åï",
          en: "Reliability, planning, diligence"
        },
        weaknesses: {
          ja: "ÊüîËªüÊÄß„ÅÆÊ¨†Â¶Ç„ÄÅÂ§âÂåñ„Å∏„ÅÆÊäµÊäó",
          en: "Lack of flexibility, resistance to change"
        },
        jobs: {
          ja: "‰ºöË®àÂ£´„ÄÅÂÖ¨ÂãôÂì°„ÄÅÁÆ°ÁêÜËÅ∑",
          en: "Accountant, civil servant, manager"
        },
        famous: {
          ja: "„Ç∏„Éß„Éº„Ç∏„Éª„ÉØ„Ç∑„É≥„Éà„É≥„ÄÅ„Éä„Çø„É™„Éº„Éª„Éù„Éº„Éà„Éû„É≥",
          en: "George Washington, Natalie Portman"
        }
      },
      "ISFJ": {
        name: { ja: "ÊìÅË≠∑ËÄÖ", en: "Protector" },
        desc: {
          ja: "ÊÄù„ÅÑ„ÇÑ„Çä„Åå„ÅÇ„Çä„ÄÅÁåÆË∫´ÁöÑ„ÄÇÂë®Âõ≤„Çí„Çµ„Éù„Éº„Éà„Åô„Çã„Åì„Å®„Å´Âñú„Å≥„ÇíÊÑü„Åò„Çã„ÄÇ",
          en: "Caring and devoted, finds joy in supporting others."
        },
        strengths: {
          ja: "ÂçîË™øÊÄß„ÄÅÂøçËÄêÂäõ„ÄÅË≤¨‰ªªÊÑü",
          en: "Cooperation, patience, responsibility"
        },
        weaknesses: {
          ja: "Ëá™Â∑±‰∏ªÂºµ„ÅÆÂº±„Åï„ÄÅÈÅéÂ∫¶„Å™Ëá™Â∑±Áä†Áâ≤",
          en: "Weak self-assertion, excessive self-sacrifice"
        },
        jobs: {
          ja: "ÁúãË≠∑Â∏´„ÄÅÊïôÂ∏´„ÄÅÁ§æ‰ºöÁ¶èÁ•âÂ£´",
          en: "Nurse, teacher, social worker"
        },
        famous: {
          ja: "„Éì„É®„É≥„Çª„ÄÅ„Éû„Ç∂„Éº„Éª„ÉÜ„É¨„Çµ",
          en: "Beyonc√©, Mother Teresa"
        }
      },
      "INFJ": {
        name: { ja: "ÊèêÂî±ËÄÖ", en: "Advocate" },
        desc: {
          ja: "ÁêÜÊÉ≥‰∏ªÁæ©ÁöÑ„ÅßÊ¥ûÂØüÂäõ„Åå„ÅÇ„Çã„ÄÇ‰ªñËÄÖ„ÅÆÊàêÈï∑„ÇíÊîØÊè¥„Åô„Çã„Åì„Å®„Å´ÊÉÖÁÜ±„ÇíÊ≥®„Åê„ÄÇ",
          en: "Idealistic and insightful, passionate about supporting others' growth."
        },
        strengths: {
          ja: "Áõ¥ÊÑüÂäõ„ÄÅÂÖ±ÊÑüÊÄß„ÄÅÊ¥ûÂØüÂäõ",
          en: "Intuition, empathy, insight"
        },
        weaknesses: {
          ja: "ÁèæÂÆüÈÄÉÈÅø„ÄÅÂÜÖÂêëÁöÑ„Åô„Åé„Çã",
          en: "Escapism, overly introverted"
        },
        jobs: {
          ja: "„Ç´„Ç¶„É≥„Çª„É©„Éº„ÄÅ‰ΩúÂÆ∂„ÄÅÂøÉÁêÜÂ≠¶ËÄÖ",
          en: "Counselor, writer, psychologist"
        },
        famous: {
          ja: "„Éû„Éº„ÉÜ„Ç£„É≥„Éª„É´„Éº„Çµ„Éº„Éª„Ç≠„É≥„Ç∞„ÉªJr.„ÄÅ„É¨„Éá„Ç£„Éº„Éª„Ç¨„Ç¨",
          en: "Martin Luther King Jr., Lady Gaga"
        }
      },
      "INTJ": {
        name: { ja: "Âª∫ÁØâÂÆ∂", en: "Architect" },
        desc: {
          ja: "Êà¶Áï•ÁöÑ„ÅßÁã¨ÂâµÁöÑ„ÄÇÈï∑ÊúüÁöÑ„Å™Ë¶ñÁÇπ„ÅßÁâ©‰∫ã„ÇíËÄÉ„Åà„Çã„ÄÇ",
          en: "Strategic and original, thinks from a long-term perspective."
        },
        strengths: {
          ja: "ÂàÜÊûêÂäõ„ÄÅË®àÁîªÊÄß„ÄÅÁã¨Á´ãÊÄß",
          en: "Analytical ability, planning, independence"
        },
        weaknesses: {
          ja: "ÊÑüÊÉÖË°®Áèæ„ÅÆ‰πè„Åó„Åï„ÄÅÈ†ëÂõ∫„Åï",
          en: "Lack of emotional expression, stubbornness"
        },
        jobs: {
          ja: "Á†îÁ©∂ËÄÖ„ÄÅ„Ç®„É≥„Ç∏„Éã„Ç¢„ÄÅÊà¶Áï•„Ç≥„É≥„Çµ„É´„Çø„É≥„Éà",
          en: "Researcher, engineer, strategy consultant"
        },
        famous: {
          ja: "„Ç§„Éº„É≠„É≥„Éª„Éû„Çπ„ÇØ„ÄÅ„Ç¢„Ç§„Ç∂„ÉÉ„ÇØ„Éª„Éã„É•„Éº„Éà„É≥",
          en: "Elon Musk, Isaac Newton"
        }
      },
      "ISTP": {
        name: { ja: "Â∑®Âå†", en: "Virtuoso" },
        desc: {
          ja: "ÂÆüË∑µÁöÑ„ÅßÊüîËªü„ÄÇÂïèÈ°åËß£Ê±∫„ÅåÂæóÊÑè„Åß„ÄÅÊñ∞„Åó„ÅÑ„Åì„Å®„Å´ÊåëÊà¶„Åô„Çã„ÅÆ„ÅåÂ•Ω„Åç„ÄÇ",
          en: "Practical and flexible, good at problem-solving and likes new challenges."
        },
        strengths: {
          ja: "ÊüîËªüÊÄß„ÄÅË¶≥ÂØüÂäõ„ÄÅÂÆüË°åÂäõ",
          en: "Flexibility, observation, execution"
        },
        weaknesses: {
          ja: "ÊÑüÊÉÖË°®Áèæ„ÅÆËã¶Êâã„Åï„ÄÅË°ùÂãïÁöÑ",
          en: "Difficulty expressing emotions, impulsive"
        },
        jobs: {
          ja: "„Ç®„É≥„Ç∏„Éã„Ç¢„ÄÅ„Éë„Ç§„É≠„ÉÉ„Éà„ÄÅËÅ∑‰∫∫",
          en: "Engineer, pilot, artisan"
        },
        famous: {
          ja: "„ÇØ„É™„É≥„Éà„Éª„Ç§„Éº„Çπ„Éà„Ç¶„ÉÉ„Éâ„ÄÅ„Éü„É©„Éª„Ç∏„Éß„É¥„Ç©„É¥„Ç£„ÉÉ„ÉÅ",
          en: "Clint Eastwood, Milla Jovovich"
        }
      },
      "ISFP": {
        name: { ja: "ÂÜíÈô∫ÂÆ∂", en: "Adventurer" },
        desc: {
          ja: "Ëä∏Ë°ìÁöÑ„ÅßËá™Áî±Â•îÊîæ„ÄÇ‰∫∫„ÇÑËá™ÁÑ∂„Å®„ÅÆË™øÂíå„ÇíÂ§ßÂàá„Å´„Åô„Çã„ÄÇ",
          en: "Artistic and free-spirited, values harmony with people and nature."
        },
        strengths: {
          ja: "ÊÑüÂèóÊÄß„ÄÅÊüîËªüÊÄß„ÄÅÊÄù„ÅÑ„ÇÑ„Çä",
          en: "Sensitivity, flexibility, compassion"
        },
        weaknesses: {
          ja: "ÂÑ™Êüî‰∏çÊñ≠„ÄÅËá™Â∑±‰∏ªÂºµ„ÅÆÂº±„Åï",
          en: "Indecisiveness, weak self-assertion"
        },
        jobs: {
          ja: "„Éá„Ç∂„Ç§„Éä„Éº„ÄÅ„Ç¢„Éº„ÉÜ„Ç£„Çπ„Éà„ÄÅ‰øùËÇ≤Â£´",
          en: "Designer, artist, childcare worker"
        },
        famous: {
          ja: "„Éû„Ç§„Ç±„É´„Éª„Ç∏„É£„ÇØ„ÇΩ„É≥„ÄÅ„Ç™„Éº„Éâ„É™„Éº„Éª„Éò„Éó„Éê„Éº„É≥",
          en: "Michael Jackson, Audrey Hepburn"
        }
      },
      "INFP": {
        name: { ja: "‰ª≤‰ªãËÄÖ", en: "Mediator" },
        desc: {
          ja: "ÁêÜÊÉ≥‰∏ªÁæ©„ÅßÊÄùÊÖÆÊ∑±„ÅÑ„ÄÇËá™ÂàÜ„ÅÆ‰æ°ÂÄ§Ë¶≥„Å´Âø†ÂÆü„Å´Áîü„Åç„Çã„ÄÇ",
          en: "Idealistic and thoughtful, lives true to personal values."
        },
        strengths: {
          ja: "ÊÉ≥ÂÉèÂäõ„ÄÅÂÖ±ÊÑüÊÄß„ÄÅË™†ÂÆü„Åï",
          en: "Imagination, empathy, sincerity"
        },
        weaknesses: {
          ja: "ÁèæÂÆüÈÄÉÈÅø„ÄÅÂÑ™Êüî‰∏çÊñ≠",
          en: "Escapism, indecisiveness"
        },
        jobs: {
          ja: "‰ΩúÂÆ∂„ÄÅ„Ç´„Ç¶„É≥„Çª„É©„Éº„ÄÅÊïôÂ∏´",
          en: "Writer, counselor, teacher"
        },
        famous: {
          ja: "„Ç¶„Ç£„É™„Ç¢„É†„Éª„Ç∑„Çß„Ç§„ÇØ„Çπ„Éî„Ç¢„ÄÅ„Ç¢„É™„Ç∑„Ç¢„Éª„Ç≠„Éº„Ç∫",
          en: "William Shakespeare, Alicia Keys"
        }
      },
      "INTP": {
        name: { ja: "Ë´ñÁêÜÂ≠¶ËÄÖ", en: "Logician" },
        desc: {
          ja: "ÂàÜÊûêÁöÑ„ÅßÁü•ÁöÑÂ•ΩÂ•áÂøÉ„ÅåÊó∫Áõõ„ÄÇÁã¨Ëá™„ÅÆÁêÜË´ñ„ÇíËøΩÊ±Ç„Åô„Çã„ÄÇ",
          en: "Analytical and curious, pursues unique theories."
        },
        strengths: {
          ja: "Ë´ñÁêÜÊÄß„ÄÅÁã¨ÂâµÊÄß„ÄÅÊüîËªüÊÄß",
          en: "Logic, originality, flexibility"
        },
        weaknesses: {
          ja: "ÂÑ™Êüî‰∏çÊñ≠„ÄÅÁ§æ‰∫§ÊÄß„ÅÆ‰Ωé„Åï",
          en: "Indecisiveness, low sociability"
        },
        jobs: {
          ja: "„Éó„É≠„Ç∞„É©„Éû„Éº„ÄÅÁ†îÁ©∂ËÄÖ„ÄÅ‰ΩúÂÆ∂",
          en: "Programmer, researcher, writer"
        },
        famous: {
          ja: "„Éì„É´„Éª„Ç≤„Ç§„ÉÑ„ÄÅ„Ç¢„É´„Éô„É´„Éà„Éª„Ç¢„Ç§„É≥„Ç∑„É•„Çø„Ç§„É≥",
          en: "Bill Gates, Albert Einstein"
        }
      },
      "ESTP": {
        name: { ja: "Ëµ∑Ê•≠ÂÆ∂", en: "Entrepreneur" },
        desc: {
          ja: "Ë°åÂãïÁöÑ„ÅßÁ§æ‰∫§ÁöÑ„ÄÇÊñ∞„Åó„ÅÑÊåëÊà¶„ÇÑÂà∫ÊøÄ„ÇíÊ±Ç„ÇÅ„Çã„ÄÇ",
          en: "Active and sociable, seeks new challenges and excitement."
        },
        strengths: {
          ja: "Ë°åÂãïÂäõ„ÄÅÊüîËªüÊÄß„ÄÅÁ§æ‰∫§ÊÄß",
          en: "Action, flexibility, sociability"
        },
        weaknesses: {
          ja: "Ë°ùÂãïÁöÑ„ÄÅË®àÁîªÊÄß„ÅÆÊ¨†Â¶Ç",
          en: "Impulsiveness, lack of planning"
        },
        jobs: {
          ja: "Âñ∂Ê•≠„ÄÅËµ∑Ê•≠ÂÆ∂„ÄÅ„Çπ„Éù„Éº„ÉÑÈÅ∏Êâã",
          en: "Sales, entrepreneur, athlete"
        },
        famous: {
          ja: "„Ç¢„Éº„Éç„Çπ„Éà„Éª„Éò„Éü„É≥„Ç∞„Ç¶„Çß„Ç§„ÄÅ„Éû„Éâ„É≥„Éä",
          en: "Ernest Hemingway, Madonna"
        }
      },
      "ESFP": {
        name: { ja: "„Ç®„É≥„Çø„Éº„ÉÜ„Ç§„Éä„Éº", en: "Entertainer" },
        desc: {
          ja: "Êòé„Çã„ÅèÁ§æ‰∫§ÁöÑ„ÄÇ‰∫∫„ÇíÊ•Ω„Åó„Åæ„Åõ„Çã„Åì„Å®„ÅåÂæóÊÑè„ÄÇ",
          en: "Cheerful and sociable, good at entertaining others."
        },
        strengths: {
          ja: "Á§æ‰∫§ÊÄß„ÄÅÊüîËªüÊÄß„ÄÅÊ•ΩË¶≥ÊÄß",
          en: "Sociability, flexibility, optimism"
        },
        weaknesses: {
          ja: "Ë°ùÂãïÁöÑ„ÄÅË®àÁîªÊÄß„ÅÆ‰Ωé„Åï",
          en: "Impulsiveness, lack of planning"
        },
        jobs: {
          ja: "‰ø≥ÂÑ™„ÄÅË≤©Â£≤Âì°„ÄÅ„Ç§„Éô„É≥„Éà‰ºÅÁîª",
          en: "Actor, salesperson, event planner"
        },
        famous: {
          ja: "„Ç®„É´„Éà„É≥„Éª„Ç∏„Éß„É≥„ÄÅ„Éû„É™„É™„É≥„Éª„É¢„É≥„É≠„Éº",
          en: "Elton John, Marilyn Monroe"
        }
      },
      "ENFP": {
        name: { ja: "Â∫ÉÂ†±ÈÅãÂãïÂÆ∂", en: "Campaigner" },
        desc: {
          ja: "ÂâµÈÄ†ÁöÑ„ÅßÊÉÖÁÜ±ÁöÑ„ÄÇ‰∫∫„Å®„ÅÆ„Å§„Å™„Åå„Çä„ÇÑÊñ∞„Åó„ÅÑ„Ç¢„Ç§„Éá„Ç¢„ÇíÂ§ßÂàá„Å´„Åô„Çã„ÄÇ",
          en: "Creative and passionate, values connections and new ideas."
        },
        strengths: {
          ja: "ÂâµÈÄ†Âäõ„ÄÅÂÖ±ÊÑüÊÄß„ÄÅÊüîËªüÊÄß",
          en: "Creativity, empathy, flexibility"
        },
        weaknesses: {
          ja: "Ê∞óÂàÜÂ±ã„ÄÅÂÑ™Êüî‰∏çÊñ≠",
          en: "Moody, indecisive"
        },
        jobs: {
          ja: "„Ç´„Ç¶„É≥„Çª„É©„Éº„ÄÅ‰ΩúÂÆ∂„ÄÅÂ∫ÉÂ†±",
          en: "Counselor, writer, public relations"
        },
        famous: {
          ja: "„É≠„Éì„É≥„Éª„Ç¶„Ç£„É™„Ç¢„É†„Ç∫„ÄÅ„Ç®„É¨„É≥„Éª„Éá„Ç∏„Çß„Éç„É¨„Çπ",
          en: "Robin Williams, Ellen DeGeneres"
        }
      },
      "ENTP": {
        name: { ja: "Ë®éË´ñËÄÖ", en: "Debater" },
        desc: {
          ja: "Áü•ÁöÑÂ•ΩÂ•áÂøÉ„ÅåÂº∑„Åè„ÄÅË≠∞Ë´ñÂ•Ω„Åç„ÄÇÊñ∞„Åó„ÅÑ„Ç¢„Ç§„Éá„Ç¢„ÇíÁîü„ÅøÂá∫„Åô„ÅÆ„ÅåÂæóÊÑè„ÄÇ",
          en: "Curious and loves debate, good at generating new ideas."
        },
        strengths: {
          ja: "Ë´ñÁêÜÊÄß„ÄÅÂâµÈÄ†ÊÄß„ÄÅÊüîËªüÊÄß",
          en: "Logic, creativity, flexibility"
        },
        weaknesses: {
          ja: "Ê∞óÂàÜÂ±ã„ÄÅË°ùÂãïÁöÑ",
          en: "Moody, impulsive"
        },
        jobs: {
          ja: "Ëµ∑Ê•≠ÂÆ∂„ÄÅÂºÅË≠∑Â£´„ÄÅ„Ç≥„É≥„Çµ„É´„Çø„É≥„Éà",
          en: "Entrepreneur, lawyer, consultant"
        },
        famous: {
          ja: "„Éà„Éº„Éû„Çπ„Éª„Ç®„Ç∏„ÇΩ„É≥„ÄÅ„Çµ„É´„Éê„Éâ„Éº„É´„Éª„ÉÄ„É™",
          en: "Thomas Edison, Salvador Dal√≠"
        }
      },
      "ESTJ": {
        name: { ja: "ÂππÈÉ®", en: "Executive" },
        desc: {
          ja: "ÁèæÂÆüÁöÑ„ÅßÁµÑÁπîÁöÑ„ÄÇ„É™„Éº„ÉÄ„Éº„Ç∑„ÉÉ„Éó„ÇíÁô∫ÊèÆ„Åô„Çã„Åì„Å®„ÅåÂ§ö„ÅÑ„ÄÇ",
          en: "Realistic and organized, often demonstrates leadership."
        },
        strengths: {
          ja: "ÁµÑÁπîÂäõ„ÄÅË≤¨‰ªªÊÑü„ÄÅÂÆüË°åÂäõ",
          en: "Organization, responsibility, execution"
        },
        weaknesses: {
          ja: "È†ëÂõ∫„Åï„ÄÅÊüîËªüÊÄß„ÅÆÊ¨†Â¶Ç",
          en: "Stubbornness, lack of flexibility"
        },
        jobs: {
          ja: "ÁÆ°ÁêÜËÅ∑„ÄÅÂÖ¨ÂãôÂì°„ÄÅÁµåÂñ∂ËÄÖ",
          en: "Manager, civil servant, executive"
        },
        famous: {
          ja: "„Éü„Ç∑„Çß„É´„Éª„Ç™„Éê„Éû„ÄÅ„Ç∏„Éß„É≥„ÉªF„Éª„Ç±„Éç„Éá„Ç£",
          en: "Michelle Obama, John F. Kennedy"
        }
      },
      "ESFJ": {
        name: { ja: "È†ò‰∫ãÂÆò", en: "Consul" },
        desc: {
          ja: "ÂçîË™øÊÄß„ÅåÈ´ò„Åè„ÄÅÂë®Âõ≤„Çí„Çµ„Éù„Éº„Éà„Åô„Çã„Åì„Å®„Å´Èï∑„Åë„Å¶„ÅÑ„Çã„ÄÇ",
          en: "Highly cooperative, excels at supporting others."
        },
        strengths: {
          ja: "ÂçîË™øÊÄß„ÄÅÊÄù„ÅÑ„ÇÑ„Çä„ÄÅË≤¨‰ªªÊÑü",
          en: "Cooperation, compassion, responsibility"
        },
        weaknesses: {
          ja: "Ëá™Â∑±‰∏ªÂºµ„ÅÆÂº±„Åï„ÄÅÈÅéÂ∫¶„Å™Ëá™Â∑±Áä†Áâ≤",
          en: "Weak self-assertion, excessive self-sacrifice"
        },
        jobs: {
          ja: "ÊïôÂ∏´„ÄÅÁúãË≠∑Â∏´„ÄÅ„Ç´„Ç¶„É≥„Çª„É©„Éº",
          en: "Teacher, nurse, counselor"
        },
        famous: {
          ja: "„ÉÜ„Ç§„É©„Éº„Éª„Çπ„Ç¶„Ç£„Éï„Éà„ÄÅ„Éì„É´„Éª„ÇØ„É™„É≥„Éà„É≥",
          en: "Taylor Swift, Bill Clinton"
        }
      },
      "ENFJ": {
        name: { ja: "‰∏ª‰∫∫ÂÖ¨", en: "Protagonist" },
        desc: {
          ja: "ÊÉÖÁÜ±ÁöÑ„ÅßÁ§æ‰∫§ÁöÑ„ÄÇ‰ªñËÄÖ„ÅÆÊàêÈï∑„ÇíÊîØÊè¥„Åô„Çã„É™„Éº„ÉÄ„Éº„Çø„Ç§„Éó„ÄÇ",
          en: "Passionate and sociable, a leader who supports others' growth."
        },
        strengths: {
          ja: "ÂÖ±ÊÑüÊÄß„ÄÅ„É™„Éº„ÉÄ„Éº„Ç∑„ÉÉ„Éó„ÄÅÁ§æ‰∫§ÊÄß",
          en: "Empathy, leadership, sociability"
        },
        weaknesses: {
          ja: "Ëá™Â∑±Áä†Áâ≤„ÄÅÊÑüÊÉÖ„ÅÆËµ∑‰ºè",
          en: "Self-sacrifice, emotional ups and downs"
        },
        jobs: {
          ja: "ÊïôÂ∏´„ÄÅ„Ç´„Ç¶„É≥„Çª„É©„Éº„ÄÅ„Éû„Éç„Éº„Ç∏„É£„Éº",
          en: "Teacher, counselor, manager"
        },
        famous: {
          ja: "„Éê„É©„ÇØ„Éª„Ç™„Éê„Éû„ÄÅ„Ç™„Éó„É©„Éª„Ç¶„Ç£„É≥„Éï„É™„Éº",
          en: "Barack Obama, Oprah Winfrey"
        }
      },
      "ENTJ": {
        name: { ja: "ÊåáÊèÆÂÆò", en: "Commander" },
        desc: {
          ja: "Ê±∫Êñ≠Âäõ„Åå„ÅÇ„Çä„ÄÅÊà¶Áï•ÁöÑ„Å´Áâ©‰∫ã„ÇíÈÄ≤„ÇÅ„Çã„É™„Éº„ÉÄ„Éº„ÄÇ",
          en: "Decisive and strategic, a natural leader."
        },
        strengths: {
          ja: "Ê±∫Êñ≠Âäõ„ÄÅË´ñÁêÜÊÄß„ÄÅ„É™„Éº„ÉÄ„Éº„Ç∑„ÉÉ„Éó",
          en: "Decisiveness, logic, leadership"
        },
        weaknesses: {
          ja: "È†ëÂõ∫„Åï„ÄÅÊÑüÊÉÖË°®Áèæ„ÅÆ‰πè„Åó„Åï",
          en: "Stubbornness, lack of emotional expression"
        },
        jobs: {
          ja: "ÁµåÂñ∂ËÄÖ„ÄÅ„Ç≥„É≥„Çµ„É´„Çø„É≥„Éà„ÄÅÂºÅË≠∑Â£´",
          en: "Executive, consultant, lawyer"
        },
        famous: {
          ja: "„Çπ„ÉÜ„Ç£„Éº„Éñ„Éª„Ç∏„Éß„Éñ„Ç∫„ÄÅ„Ç¥„Éº„Éâ„É≥„Éª„É©„É†„Çº„Ç§",
          en: "Steve Jobs, Gordon Ramsay"
        }
      }
    };

    const QUESTIONS_PER_PAGE = 8;
    let answers = [];
    let currentPage = 0;
    let lang = "ja";
    let errorQuestions = [];
    let continued = false;

    // --- „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏ ---
    function saveProgress() {
      localStorage.setItem("mbti_answers", JSON.stringify(answers));
      localStorage.setItem("mbti_page", currentPage);
      localStorage.setItem("mbti_lang", lang);
    }
    function loadProgress() {
      answers = JSON.parse(localStorage.getItem("mbti_answers") || "[]");
      currentPage = parseInt(localStorage.getItem("mbti_page") || "0", 10);
      lang = localStorage.getItem("mbti_lang") || "ja";
    }
    function clearProgress() {
      localStorage.removeItem("mbti_answers");
      localStorage.removeItem("mbti_page");
      localStorage.removeItem("mbti_lang");
      answers = [];
      currentPage = 0;
      continued = false;
    }

    function switchLang(newLang) {
      lang = newLang;
      saveProgress();
      renderQuestions();
    }

    function renderQuestions() {
      const app = document.getElementById("app");
      app.innerHTML = "";
      const data = DATA[lang];

      const answeredCount = answers.filter(a => a !== undefined).length;
      app.innerHTML += `
        <div class="progress-bar-bg">
          <div class="progress-bar" style="width:${100*answeredCount/data.questions.length}%"></div>
        </div>
        <div style="text-align:right;color:#555;margin-bottom:16px;">
          ${data.remain(data.questions.length-answeredCount)}
        </div>
      `;
      if(errorQuestions.length) {
        app.innerHTML += `<div class="error-message">${data.error}</div>`;
      }
      const start = currentPage * QUESTIONS_PER_PAGE;
      const end = Math.min(start + QUESTIONS_PER_PAGE, data.questions.length);
      for(let i=start; i<end; i++) {
        const q = data.questions[i];
        app.innerHTML += `
          <div class="question-card${errorQuestions.includes(i)?' unanswered':''}" data-index="${i}">
            <div style="font-size:1.1rem;" id="q${i}_label">${i+1}. ${q.text} <span aria-hidden="true" style="font-size:1.5rem;">${q.img}</span></div>
            <div class="options" role="radiogroup" aria-labelledby="q${i}_label">
              ${[5,4,3,2,1].map(v => {
                const id = `q${i}_${v}`;
                const lbl = data.options[5-v];
                return `
                  <input type="radio" id="${id}" name="q${i}" value="${v}" ${answers[i]==v?"checked":""} style="display:none;">
                  <label class="option-label" for="${id}" tabindex="0">${lbl}</label>
                `;
              }).join('')}
            </div>
          </div>
        `;
      }
      let nav = `<div style="text-align:center;margin-top:24px;">`;
      if(currentPage > 0)
        nav += `<button class="nav-btn" onclick="prevPage()" type="button">${data.prev}</button> `;
      if(end < data.questions.length)
        nav += `<button class="nav-btn" onclick="nextPage()" type="button">${data.next}</button>`;
      else
        nav += `<button id="submitBtn" onclick="submitAnswers()" type="button">${data.submit}</button>`;
      nav += `</div>`;
      app.innerHTML += nav;
      document.querySelectorAll('.options input[type=radio]').forEach(input => {
        input.addEventListener('change', function() {
          const idx = parseInt(this.name.replace("q",""),10);
          answers[idx] = parseInt(this.value,10);
          saveProgress();
          const label = document.querySelector(`label[for="${this.id}"]`);
          if(label) {
            label.classList.remove('animate');
            void label.offsetWidth;
            label.classList.add('animate');
          }
        });
      });
      document.querySelectorAll('.option-label').forEach(label => {
        label.addEventListener('keydown', function(e) {
          if(e.key === " " || e.key === "Enter") {
            e.preventDefault();
            document.getElementById(label.htmlFor).checked = true;
            document.getElementById(label.htmlFor).dispatchEvent(new Event("change"));
          }
        });
        label.addEventListener('click', function() {
          label.classList.remove('animate');
          void label.offsetWidth;
          label.classList.add('animate');
        });
      });
    }
    function prevPage() {
      currentPage--;
      saveProgress();
      renderQuestions();
      window.scrollTo({top:0, behavior:"smooth"});
    }
    function nextPage() {
      currentPage++;
      saveProgress();
      renderQuestions();
      window.scrollTo({top:0, behavior:"smooth"});
    }
    function submitAnswers() {
      const data = DATA[lang];
      errorQuestions = [];
      for(let i=0;i<data.questions.length;i++) {
        if(answers[i] === undefined) errorQuestions.push(i);
      }
      if(errorQuestions.length) {
        renderQuestions();
        const first = document.querySelector('.question-card.unanswered');
        if(first) first.scrollIntoView({behavior:"smooth", block:"center"});
        return;
      }
      renderResult();
      gtag('event', 'submit', {event_category: 'MBTI', event_label: 'submit'});
    }
    function renderResult() {
      // ‚òÖ„Åì„Åì„ÅßÂøÖ„Åö„Éö„Éº„Ç∏‰∏äÈÉ®„Å∏„Çπ„ÇØ„É≠„Éº„É´
      window.scrollTo({top:0, behavior:"smooth"});
      const app = document.getElementById("app");
      const data = DATA[lang];
      const questions = data.questions;
      const axes = {E:0,I:0,N:0,S:0,T:0,F:0,J:0,P:0}, counts = {E:0,I:0,N:0,S:0,T:0,F:0,J:0,P:0};
      questions.forEach((q,i) => {
        axes[q.axis] += answers[i];
        counts[q.axis]++;
      });
      function axisLetter(pos,neg) {
        const diff = (axes[pos]/counts[pos]) - (axes[neg]/counts[neg]);
        return diff > 0 ? pos : neg;
      }
      const mbti = axisLetter("E","I") + axisLetter("N","S") + axisLetter("T","F") + axisLetter("J","P");
      const detail = MBTI_TYPES[mbti];
      function axisBar(pos,neg,color) {
        const posAvg = axes[pos]/counts[pos], negAvg = axes[neg]/counts[neg];
        const percent = Math.round(100 * (posAvg / (posAvg+negAvg)));
        return `
          <div>
            <div style="display:flex;justify-content:space-between;font-size:0.98rem;">
              <span>${pos}</span><span>${neg}</span>
            </div>
            <div class="progress-bar-bg">
              <div class="progress-bar" style="width:${percent}%;background:${color};"></div>
            </div>
            <div style="text-align:center;font-size:0.93rem;">${percent}% ${pos} / ${100-percent}% ${neg}</div>
          </div>
        `;
      }
      const shareText = lang==="ja" ? `ÁßÅ„ÅÆMBTIË®∫Êñ≠ÁµêÊûú„ÅØ${mbti}Ôºà${detail.name.ja}Ôºâ„Åß„Åó„ÅüÔºÅ` : `My MBTI result is ${mbti} (${detail.name.en})!`;
      const shareUrl = location.href.split('?')[0]+'?result='+mbti+'&lang='+lang;
      app.innerHTML = `
        <h2 style="text-align:center;">${data.typeLabel(mbti, detail.name[lang])}</h2>
        <div class="result-type-card">
          <h3>${detail.name[lang]}Ôºà${mbti}Ôºâ</h3>
          <div>${detail.desc[lang]}</div>
          <div><b>${lang==="ja"?"Âº∑„Åø":"Strengths"}Ôºö</b>${detail.strengths[lang]}</div>
          <div><b>${lang==="ja"?"Âº±„Åø":"Weaknesses"}Ôºö</b>${detail.weaknesses[lang]}</div>
          <div><b>${lang==="ja"?"Âêë„ÅÑ„Å¶„ÅÑ„Çã‰ªï‰∫ã":"Jobs"}Ôºö</b>${detail.jobs[lang]}</div>
          <div><b>${lang==="ja"?"ÊúâÂêç‰∫∫‰æã":"Famous"}Ôºö</b>${detail.famous[lang]}</div>
        </div>
        <div style="max-width:600px;margin:0 auto 2.5rem;">
          ${axisBar("E","I","#2196F3")}
          ${axisBar("N","S","#8bc34a")}
          ${axisBar("T","F","#ff9800")}
          ${axisBar("J","P","#9c27b0")}
        </div>
        <div style="text-align:center;margin:2rem 0;">
          <button id="resetBtn" onclick="resetAll()">${data.reset}</button>
        </div>
        <div style="text-align:center;">
          <a class="share-btn x" href="https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}" target="_blank">${data.share.x}</a>
          <a class="share-btn line" href="https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(shareUrl)}" target="_blank">${data.share.line}</a>
          <a class="share-btn facebook" href="https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}" target="_blank">${data.share.facebook}</a>
          <button class="share-btn instagram" onclick="copyToClipboard('${shareText}\\n${shareUrl}','${lang==="ja"?"Instagram„Å´Ë≤º„Çä‰ªò„Åë„Å¶„Ç∑„Çß„Ç¢„Åó„Å¶„Åè„Å†„Åï„ÅÑ":"Copy and paste to Instagram"}');return false;">${data.share.instagram}</button>
          <button class="share-btn copy" onclick="copyToClipboard('${shareText}\\n${shareUrl}','${lang==="ja"?"ÁµêÊûú„Çí„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü":"Copied!"}');return false;">${data.share.copy}</button>
        </div>
        <div style="text-align:center;margin-top:1.5rem;color:#888;font-size:0.95rem;">
          ${data.resultNote}
        </div>
      `;
      history.replaceState(null,null,`?result=${mbti}&lang=${lang}`);
    }
    function copyToClipboard(text, alertMsg) {
      if(navigator.clipboard) {
        navigator.clipboard.writeText(text).then(()=>{ alert(alertMsg); });
      } else {
        const t = document.createElement("textarea");
        t.value = text;
        document.body.appendChild(t);
        t.select();
        document.execCommand("copy");
        document.body.removeChild(t);
        alert(alertMsg);
      }
    }
    function resetAll() {
      clearProgress();
      renderQuestions();
      window.scrollTo({top:0, behavior:"smooth"});
    }
    function checkResultParam() {
      const params = new URLSearchParams(location.search);
      const result = params.get("result");
      lang = params.get("lang") || "ja";
      if(result && MBTI_TYPES[result]) {
        const app = document.getElementById("app");
        const data = DATA[lang];
        const detail = MBTI_TYPES[result];
        const shareText = lang==="ja" ? `ÁßÅ„ÅÆMBTIË®∫Êñ≠ÁµêÊûú„ÅØ${result}Ôºà${detail.name.ja}Ôºâ„Åß„Åó„ÅüÔºÅ` : `My MBTI result is ${result} (${detail.name.en})!`;
        const shareUrl = location.href;
        app.innerHTML = `
          <h2 style="text-align:center;">${data.typeLabel(result, detail.name[lang])}</h2>
          <div class="result-type-card">
            <h3>${detail.name[lang]}Ôºà${result}Ôºâ</h3>
            <div>${detail.desc[lang]}</div>
            <div><b>${lang==="ja"?"Âº∑„Åø":"Strengths"}Ôºö</b>${detail.strengths[lang]}</div>
            <div><b>${lang==="ja"?"Âº±„Åø":"Weaknesses"}Ôºö</b>${detail.weaknesses[lang]}</div>
            <div><b>${lang==="ja"?"Âêë„ÅÑ„Å¶„ÅÑ„Çã‰ªï‰∫ã":"Jobs"}Ôºö</b>${detail.jobs[lang]}</div>
            <div><b>${lang==="ja"?"ÊúâÂêç‰∫∫‰æã":"Famous"}Ôºö</b>${detail.famous[lang]}</div>
          </div>
          <div style="text-align:center;margin:2rem 0;">
            <button id="resetBtn" onclick="resetAll()">${data.reset}</button>
          </div>
          <div style="text-align:center;">
            <a class="share-btn x" href="https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}" target="_blank">${data.share.x}</a>
            <a class="share-btn line" href="https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(shareUrl)}" target="_blank">${data.share.line}</a>
            <a class="share-btn facebook" href="https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}" target="_blank">${data.share.facebook}</a>
            <button class="share-btn instagram" onclick="copyToClipboard('${shareText}\\n${shareUrl}','${lang==="ja"?"Instagram„Å´Ë≤º„Çä‰ªò„Åë„Å¶„Ç∑„Çß„Ç¢„Åó„Å¶„Åè„Å†„Åï„ÅÑ":"Copy and paste to Instagram"}');return false;">${data.share.instagram}</button>
            <button class="share-btn copy" onclick="copyToClipboard('${shareText}\\n${shareUrl}','${lang==="ja"?"ÁµêÊûú„Çí„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü":"Copied!"}');return false;">${data.share.copy}</button>
          </div>
        `;
        window.scrollTo({top:0, behavior:"smooth"});
        return true;
      }
      return false;
    }

    window.onload = function(){
      if(checkResultParam()) return;
      loadProgress();
      renderQuestions();
    };
  </script>
</body>
</html>
